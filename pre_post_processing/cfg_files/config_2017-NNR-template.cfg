#============
# job details
#============
# N.B., keeping with python convention you must capitalize
# True and False for Booleans!

job = raijin ; options are 'smp' or 'cluster' or 'raijin'.
nproc = -1 ; -1 to use all available procs.
# For 'smp', 'nproc'=1 is the serial case.
# For 'cluster' or 'raijin', 'nproc' is ignored.

jobname = mkhist-a_start-a_end ; for cluster job only
walltime = cputime ; for cluster job only
mem = vmem ; (in GB) for raijin job only 
email = nflament@uow.edu.au ; for raijin job only

age_start = a_start
age_end = a_end

DEBUG = False ; generic switch for debugging
VERBOSE = True ; show terminal output

# do not remove processed age and final temperature grids
KEEP_GRIDS = False
PLOT_SUMMARY_POSTSCRIPT = True; make a summary ps file for each depth
KEEP_PS = False

model_name = PM_2017_NNR ; history model name for output

#============
# data output
#============

# [INITIAL CONDITION]
# temperature initial condition
OUTPUT_TEMP_IC = temp_ic

# tracer initial condition
OUTPUT_TRAC_IC = tracer_ic

# [HISTORY]
# slab temperature history
OUTPUT_TEMP = True

# internal velocity (slab descent) 
OUTPUT_IVEL = False

# thermal age of lithosphere
OUTPUT_LITH_AGE = True

#========================
# data output directories
#========================
# N.B. use an absolute path for job = cluster

grid_dir = /short/q97/nif562/Global/Lith_Def/Preprocessing/2017_NNR/a_start-a_end/grid ; intermediate grids
hist_dir = /short/q97/nif562/Global/Lith_Def/Preprocessing/2017_NNR/Reconstruction/hist ; history
ic_dir = /short/q97/nif562/Global/Lith_Def/Preprocessing/2017_NNR/Reconstruction/ic ; initial condition
ivel_dir = /short/q97/nif562/Global/Lith_Def/Preprocessing/2017_NNR/ivel ; ivel
lith_age_dir = /short/q97/nif562/Global/Lith_Def/Preprocessing/2017_NNR/Reconstruction/age ; age
log_dir = /short/q97/nif562/Global/Lith_Def/Preprocessing/2017_NNR/a_start-a_end ; parameters
ps_dir = /short/q97/nif562/Global/Lith_Def/Preprocessing/2017_NNR/ps ; postscripts
trac_dir = /short/q97/nif562/Global/Lith_Def/Preprocessing/2017_NNR/Reconstruction/tracers ; tracers

#===========
# data input
#===========
# N.B. use an absolute path for job = cluster

#pid_file = /short/q97/nif562/Global/Lith_Def/Preprocessing/2017_NNR/pid10313.cfg ; CitcomS pid file
pid_file = /short/q97/nif562/Global/Lith_Def/Preprocessing/2017_NNR/pid000009569 ; CitcomS pid file

# default coordinate file path is:
#     [datadir]/[proc]/[datafile].coord.[proc]
# or define a user-specified directory to all of the
# [datafile].coord.[proc] files:
coord_dir = /short/q97/nif562/Global/Lith_Def/Preprocessing/test-2014v1-svn460/Reconstruction/Coord ; CitcomS *.coord.* files

# spatial resolution of the prescribed ivel bcs
# levels = 1 ; prescribe at finest mesh
# levels = 2 ; coarsen by 2 in each dimension
# levels = 3 ; coarsen by 4 in each dimension
# for global models you'll likely need levels >= 2
# for regional models try levels = 1 and then increase
# if convergence is poor or solve time is unreasonable
levels = 2


#===================
# thermal parameters
#===================
# mantle temperature at the surface
temperature_mantle = 0.365

BUILD_LITHOSPHERE = True ; include an upper thermal boundary layer
UTBL_AGE_GRID = True ; True will use age grids
utbl_age = 300 ; if UTBL_AGE_GRID is False
lith_age_min = 0.01 ; minimum lithosphere thermal age
# note that the below only truncates oceanic regions
oceanic_lith_age_max = 80.0 ; maximum oceanic thermal age
# thermal age for non-oceanic regions if CONTINENTAL_TYPES = False
NaN_age = 100.0


BUILD_SLAB = True ; build slabs
radius_of_curvature = 200.0 ; km
# default values for slab dip and depth if GPML_HEADER = False
default_slab_dip = 45.0 ; degrees
default_slab_depth = 425.0 ; km
UM_advection = 1.0 ; non-dim factor
LM_advection = 2.0 ; non-dim factor
vertical_slab_depth = 425.0 ; depth at which to make slabs vertical

# GPML_HEADER must be True for subduction initiation
GPML_HEADER = True ; override defaults with GPML header data
slab_UM_descent_rate = 3.0 ; cm/yr
# from van der Meer et al. (2010)
slab_LM_descent_rate = 1.2 ; cm/yr

FLAT_SLAB = True ; include flat slabs
FLAT_SLAB_RAMP = True ; include sub-horizontal part of flat slabs

# lower thermal boundary layer
# with LTBL, the temperature of the CMB is always 1
BUILD_LTBL  = True ; lower thermal boundary layer
ltbl_age = 300 ; age (Ma) of tbl
temperature_cmb = 1

# thermal blobs
BUILD_BLOB = False ; thermal blobs
blob_center_lon = 50, 130 ; degrees
blob_center_lat = 45, 45 ; degrees colat
blob_center_depth = 2867, 2867 ; km
blob_radius = 200, 400 ; km
blob_birth_age = 230, 220 ; Ma
blob_dT = 0.1, 0.1 ; non-dimensional temperature anomaly
blob_profile = constant, constant ; valid profiles (constant, exponential, gaussian1, gaussian2)

# thermal silos
BUILD_SILO = False ; thermal silos
silo_base_center_lon = 50, 130 ; degrees
silo_base_center_lat = 90, 90 ; degrees colat
silo_base_center_depth = 2867, 2867 ; km
silo_radius = 200, 400 ; km
silo_cylinder_height= 500, 500 ; km
silo_birth_age = 230, 220 ; Ma
silo_dT = 0.1, 0.1 ; non-dimensional temperature anomaly
silo_profile = constant, constant ; valid profiles (constant, exponential, gaussian1, gaussian2)

# ADIABAT only for extended-Boussinesq or compressible models
BUILD_ADIABAT = True ; linear temp increase across mantle
# non-dimensional adiabatic temperature drop scaled with respect
# to the total temperature drop across the model
adiabat_temp_drop = 0.27


#===========
# Continents
#===========
# Build upper thermal boundary layer with continents
# Also continental tracers (if OUTPUT_TRAC_IC is also True)
CONTINENTAL_TYPES = True

# For continental types, list stencil values with no spaces delimited 
# by a comma. Use negative integers.
# Then, for each stencil give the age for reassignment
# In the example below, -1 is Archean, -2 Proterozoic, -3 Phanerozoic,
# and -4 COB.
# ensure stencil_values are small negative integers

stencil_values = -4,-3,-2,-1
stencil_ages = 104,103,153,369

# No assimilation in areas that have been deformed
NO_ASSIM = False
no_ass_age = -1000
no_ass_padding = 100

# Exclude tracers in areas that have been deformed
# to a depth defined by 'tracer_no_ass_depth'
# also uses no_ass_age and no_ass_padding
# and CONTINENTAL_TYPES must be True
# also, no_ass_age must be more negative than the
# most negative stencil value
TRACER_NO_ASSIM = False
tracer_no_ass_depth = 350 ; km

# Build tracer field with continents using 'stencil_values'
# tracer flavors and depths

# for positive thermal ages (i.e., oceanic)
# note: must be '0' suffix
flavor_stencil_value_0 = 0
depth_stencil_value_0 = 410

# for stencil value -1
flavor_stencil_value_1 = 1,2
depth_stencil_value_1 = 40,250

# for stencil value -2
flavor_stencil_value_2 = 1,3
depth_stencil_value_2 = 40,160

# for stencil value -3
flavor_stencil_value_3 = 1,4
depth_stencil_value_3 = 40,130

# for stencil value -4
flavor_stencil_value_4 = 1,4
depth_stencil_value_4 = 40,130

# etc. for more stencil values, e.g.,
# flavor_stencil_value_5 = 0 
# depth_stencil_value_5 = 410

#=========================
# tracer initial condition
#=========================
# this is approximate, because tracers are uniformly distributed
tracers_per_element = 30

# set region around slabs to ambient flavor (0)
SLAB_STENCIL = True
# stencil width: 300 km is consistent with the default width of the thermal stencil
# wide stencils limit crustal thickening along convergent margins
# narrow stencils avoid a gap along convergent margins but may result in significant
# crustal thickening and unrealistic elevations along convergent margins
slab_stencil_width = 100 ; km - suggested range: 100-300 km

# uniform dense layer at base of mantle
DEEP_LAYER_TRACERS = True
deep_layer_thickness = 113 ; km - 113 km gives 2 per cent of Earth's volume and 220 km gives 4 per cent
# flavor should not be 0 (0 is always ambient flavor)
deep_layer_flavor = 5

# eliminate tracers between these bounds
# this saves memory when using the hybrid method to compute composition
NO_TRACER_REGION = True
no_tracer_min_depth = 410 ; km
no_tracer_max_depth = 2604 ; km

#==============================
# synthetic regional model only
#==============================
SYNTHETIC = False ; master switch for synthetic regional models
OUTPUT_BVEL = True ; output velocity boundary conditions
bvel_dir = /short/q97/nif562/Global/Lith_Def/Preprocessing/2017_NNR/bvel ; bvel
fi_trench = 0.8 ; radians
TRENCH_CURVING = False
curving_trench_lat = 0.0 ; degrees
subduction_zone_age = 100 ; Ma
plate_velocity = 5 ; cm/yr
plate_velocity_theta = -1 ; direction of velocity (non-dim)
plate_velocity_phi = 1 ; direction of velocity (non-dim)
velocity_smooth = 200 ; bvel smoothing (Gaussian filter)
no_of_edge_nodes_to_zero = 3 ; no of edge nodes to smooth across (x and y)
overriding_age = 50 ; Ma
rollback_start_age = 100 ; Ma
rollback_cm_yr = 0 ; cm/yr (direction is always -phi)

